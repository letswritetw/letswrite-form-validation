/**
 * TWzipcode
 * https://code.essoduke.org/twzipcode/nojquery
 * Copyright 2019 essoduke.org, Licensed MIT.
 *
 *
 * @author  Essoduke Chang<essoduke@gmail.com>
 * @license MIT License
 */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():window.TWzipcode=t()}(0,(function(){"use strict";var e,t={"基隆市":{"仁愛區":"200","信義區":"201","中正區":"202","中山區":"203","安樂區":"204","暖暖區":"205","七堵區":"206"},"臺北市":{"中正區":"100","大同區":"103","中山區":"104","松山區":"105","大安區":"106","萬華區":"108","信義區":"110","士林區":"111","北投區":"112","內湖區":"114","南港區":"115","文山區":"116"},"新北市":{"萬里區":"207","金山區":"208","板橋區":"220","汐止區":"221","深坑區":"222","石碇區":"223","瑞芳區":"224","平溪區":"226","雙溪區":"227","貢寮區":"228","新店區":"231","坪林區":"232","烏來區":"233","永和區":"234","中和區":"235","土城區":"236","三峽區":"237","樹林區":"238","鶯歌區":"239","三重區":"241","新莊區":"242","泰山區":"243","林口區":"244","蘆洲區":"247","五股區":"248","八里區":"249","淡水區":"251","三芝區":"252","石門區":"253"},"宜蘭縣":{"宜蘭市":"260","頭城鎮":"261","礁溪鄉":"262","壯圍鄉":"263","員山鄉":"264","羅東鎮":"265","三星鄉":"266","大同鄉":"267","五結鄉":"268","冬山鄉":"269","蘇澳鎮":"270","南澳鄉":"272","釣魚臺列嶼":"290"},"新竹市":{"東區":"300","北區":"300","香山區":"300"},"新竹縣":{"竹北市":"302","湖口鄉":"303","新豐鄉":"304","新埔鎮":"305","關西鎮":"306","芎林鄉":"307","寶山鄉":"308","竹東鎮":"310","五峰鄉":"311","橫山鄉":"312","尖石鄉":"313","北埔鄉":"314","峨眉鄉":"315"},"桃園市":{"中壢區":"320","平鎮區":"324","龍潭區":"325","楊梅區":"326","新屋區":"327","觀音區":"328","桃園區":"330","龜山區":"333","八德區":"334","大溪區":"335","復興區":"336","大園區":"337","蘆竹區":"338"},"苗栗縣":{"竹南鎮":"350","頭份市":"351","三灣鄉":"352","南庄鄉":"353","獅潭鄉":"354","後龍鎮":"356","通霄鎮":"357","苑裡鎮":"358","苗栗市":"360","造橋鄉":"361","頭屋鄉":"362","公館鄉":"363","大湖鄉":"364","泰安鄉":"365","銅鑼鄉":"366","三義鄉":"367","西湖鄉":"368","卓蘭鎮":"369"},"臺中市":{"中區":"400","東區":"401","南區":"402","西區":"403","北區":"404","北屯區":"406","西屯區":"407","南屯區":"408","太平區":"411","大里區":"412","霧峰區":"413","烏日區":"414","豐原區":"420","后里區":"421","石岡區":"422","東勢區":"423","和平區":"424","新社區":"426","潭子區":"427","大雅區":"428","神岡區":"429","大肚區":"432","沙鹿區":"433","龍井區":"434","梧棲區":"435","清水區":"436","大甲區":"437","外埔區":"438","大安區":"439"},"彰化縣":{"彰化市":"500","芬園鄉":"502","花壇鄉":"503","秀水鄉":"504","鹿港鎮":"505","福興鄉":"506","線西鄉":"507","和美鎮":"508","伸港鄉":"509","員林市":"510","社頭鄉":"511","永靖鄉":"512","埔心鄉":"513","溪湖鎮":"514","大村鄉":"515","埔鹽鄉":"516","田中鎮":"520","北斗鎮":"521","田尾鄉":"522","埤頭鄉":"523","溪州鄉":"524","竹塘鄉":"525","二林鎮":"526","大城鄉":"527","芳苑鄉":"528","二水鄉":"530"},"南投縣":{"南投市":"540","中寮鄉":"541","草屯鎮":"542","國姓鄉":"544","埔里鎮":"545","仁愛鄉":"546","名間鄉":"551","集集鎮":"552","水里鄉":"553","魚池鄉":"555","信義鄉":"556","竹山鎮":"557","鹿谷鄉":"558"},"嘉義市":{"東區":"600","西區":"600"},"嘉義縣":{"番路鄉":"602","梅山鄉":"603","竹崎鄉":"604","阿里山鄉":"605","中埔鄉":"606","大埔鄉":"607","水上鄉":"608","鹿草鄉":"611","太保市":"612","朴子市":"613","東石鄉":"614","六腳鄉":"615","新港鄉":"616","民雄鄉":"621","大林鎮":"622","溪口鄉":"623","義竹鄉":"624","布袋鎮":"625"},"雲林縣":{"斗南鎮":"630","大埤鄉":"631","虎尾鎮":"632","土庫鎮":"633","褒忠鄉":"634","東勢鄉":"635","臺西鄉":"636","崙背鄉":"637","麥寮鄉":"638","斗六市":"640","林內鄉":"643","古坑鄉":"646","莿桐鄉":"647","西螺鎮":"648","二崙鄉":"649","北港鎮":"651","水林鄉":"652","口湖鄉":"653","四湖鄉":"654","元長鄉":"655"},"臺南市":{"中西區":"700","東區":"701","南區":"702","北區":"704","安平區":"708","安南區":"709","永康區":"710","歸仁區":"711","新化區":"712","左鎮區":"713","玉井區":"714","楠西區":"715","南化區":"716","仁德區":"717","關廟區":"718","龍崎區":"719","官田區":"720","麻豆區":"721","佳里區":"722","西港區":"723","七股區":"724","將軍區":"725","學甲區":"726","北門區":"727","新營區":"730","後壁區":"731","白河區":"732","東山區":"733","六甲區":"734","下營區":"735","柳營區":"736","鹽水區":"737","善化區":"741","大內區":"742","山上區":"743","新市區":"744","安定區":"745"},"高雄市":{"新興區":"800","前金區":"801","苓雅區":"802","鹽埕區":"803","鼓山區":"804","旗津區":"805","前鎮區":"806","三民區":"807","楠梓區":"811","小港區":"812","左營區":"813","仁武區":"814","大社區":"815","東沙群島":"817","南沙群島":"819","岡山區":"820","路竹區":"821","阿蓮區":"822","田寮區":"823","燕巢區":"824","橋頭區":"825","梓官區":"826","彌陀區":"827","永安區":"828","湖內區":"829","鳳山區":"830","大寮區":"831","林園區":"832","鳥松區":"833","大樹區":"840","旗山區":"842","美濃區":"843","六龜區":"844","內門區":"845","杉林區":"846","甲仙區":"847","桃源區":"848","那瑪夏區":"849","茂林區":"851","茄萣區":"852"},"屏東縣":{"屏東市":"900","三地門鄉":"901","霧臺鄉":"902","瑪家鄉":"903","九如鄉":"904","里港鄉":"905","高樹鄉":"906","鹽埔鄉":"907","長治鄉":"908","麟洛鄉":"909","竹田鄉":"911","內埔鄉":"912","萬丹鄉":"913","潮州鎮":"920","泰武鄉":"921","來義鄉":"922","萬巒鄉":"923","崁頂鄉":"924","新埤鄉":"925","南州鄉":"926","林邊鄉":"927","東港鎮":"928","琉球鄉":"929","佳冬鄉":"931","新園鄉":"932","枋寮鄉":"940","枋山鄉":"941","春日鄉":"942","獅子鄉":"943","車城鄉":"944","牡丹鄉":"945","恆春鎮":"946","滿州鄉":"947"},"臺東縣":{"臺東市":"950","綠島鄉":"951","蘭嶼鄉":"952","延平鄉":"953","卑南鄉":"954","鹿野鄉":"955","關山鎮":"956","海端鄉":"957","池上鄉":"958","東河鄉":"959","成功鎮":"961","長濱鄉":"962","太麻里鄉":"963","金峰鄉":"964","大武鄉":"965","達仁鄉":"966"},"花蓮縣":{"花蓮市":"970","新城鄉":"971","秀林鄉":"972","吉安鄉":"973","壽豐鄉":"974","鳳林鎮":"975","光復鄉":"976","豐濱鄉":"977","瑞穗鄉":"978","萬榮鄉":"979","玉里鎮":"981","卓溪鄉":"982","富里鄉":"983"},"金門縣":{"金沙鎮":"890","金湖鎮":"891","金寧鄉":"892","金城鎮":"893","烈嶼鄉":"894","烏坵鄉":"896"},"連江縣":{"南竿鄉":"209","北竿鄉":"210","莒光鄉":"211","東引鄉":"212"},"澎湖縣":{"馬公市":"880","西嶼鄉":"881","望安鄉":"882","七美鄉":"883","白沙鄉":"884","湖西鄉":"885"}},n=(e={},{get:function(t,n){return!!t&&([].forEach.call(t.attributes,(function(t){if(/^data-/.test(t.name)){var n=t.name.substr(5).replace(/-(.)/g,(function(e,t){return t.toUpperCase()}));e[n]=t.value}})),"string"==typeof n&&n in e?JSON.parse(['"',o(e[n]),'"'].join("")):void 0===n?e:void 0)},set:function(t,n,o){if(!t)return!1;"string"==typeof n&&(e[n]=o),Object.keys(e).forEach((function(n){var o,r,i="data-"+n.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})),a=(o=JSON.stringify(e[n]).slice(1,-1),(r=document.createElement("div")).appendChild(document.createTextNode(o)),r.innerHTML);t.setAttribute(i,a)}))}});function o(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText||t.textContent}function r(e){return"string"==typeof e?e.replace(/[台]+/gi,"臺"):e}function i(e,t,n){e.addEventListener(t,n,!1)}function a(){var e={},t=!1,n=0,o=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(t=arguments[0],n+=1);for(var r=function(n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=t&&"[object Object]"===Object.prototype.toString.call(n[o])?a(!0,e[o],n[o]):n[o])};n<o;n++){var i=arguments[n];r(i)}return e}function c(e,t){var n;-1!==t.indexOf(".")?window.CustomEvent?n=new CustomEvent(t):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0):document.createEvent?(n=document.createEvent("HTMLEvents")).initEvent(t,!0,!0):(n=document.createEventObject()).eventType=t,n.eventName=t,document.createEvent?e.dispatchEvent(n):e.fireEvent("on"+n.eventType,n)}function s(e,n){if(this.islands=["釣魚臺列嶼","東沙群島","南沙群島","綠島鄉","蘭嶼鄉","金門縣","連江縣","澎湖縣"],this.namespace="twzipcode",this.container="string"==typeof e?document.querySelectorAll(e):!!function(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}(e)&&e,!1===this.container)throw"Initialize failed";this.options=a(!0,{county:{label:"縣市",name:"county",value:"",css:"",hidden:!1,required:!0,onSelect:null},district:{label:"鄉鎮市區",name:"district",value:"",css:"",hidden:!1,required:!0,onSelect:null},zipcode:{name:"zipcode",value:"",css:"",hidden:!1,type:"text",min:0,max:0,step:1,placeholder:"",maxlength:3,pattern:"\\d+",readonly:!1,required:!0,onKeyUp:null,onFocus:null,onBlur:null},GMAP_KEY:"",detect:!1,combine:!1,island:!0,database:{}},n),this.options.database&&0!==Object.keys(this.options.database).length&&(t=this.options.database,delete this.options.database),this.database=t,this.init()}return s.prototype.getOpt=function(){var e,t,n=this.options,o=Array.prototype.slice.call(arguments,0);return o.forEach((function(o,r){if(t&&t.hasOwnProperty(o))e=t[o];else{if(!n.hasOwnProperty(o))return void(e=t);t=n[o],e=t}})),e},s.prototype.createDropdownList=function(e,t,o,s){var u,l,d,p=this,y=a(!0,s,n.get(e)),f=document.createElement("select"),h=['<option value="">'+(y.hasOwnProperty("label")?y.label:s.label)+"</option>"],v=[],m=[],b="change",g=r(y.value);if(!1===p.getOpt("island")&&(m=m.concat(p.islands)),y.hidden&&(Array.isArray(y.hidden)?m.concat(y.hidden):"string"==typeof y.hidden&&m.concat(y.hidden.toString().split(",")),m=m.map((function(e){return r(e.trim())}))),v.push(h.join("")),"county"===o)for(d in p.database)void 0!==p.database[d]&&-1===m.indexOf(d)&&(u=g===d?' selected="selected"':"",v.push(['<option value="',d,'" ',u,">",d,"</option>"].join("")));switch(f.setAttribute("name",y.name),f.setAttribute("id",[o,"-",t].join("")),f.className+=[y.css].join(""),f.innerHTML=v.join(""),n.set(f,"default",h.join("")),f.removeAttribute("data-role"),y.required&&f.setAttribute("required",!0),o){case"county":i(f,b,(function(e){var o,i,a=p.getEl(t,"district"),s=p.getEl(t,"zipcode"),u=r(this.options[this.selectedIndex].value),l=n.get(a,"value"),d=[],f=[],h="";if(a.innerHTML=n.get(a,"default"),s&&y.hasOwnProperty("onSelect")&&"function"==typeof y.onSelect&&y.onSelect.call(this,e),!1===p.getOpt("island")&&(d=d.concat(p.islands)),y.hasOwnProperty("hidden")&&("string"==typeof y.hidden?d.concat(y.hidden.split(",")):Array.isArray(y.hidden)&&d.concat(y.hidden),d=d.map((function(e){return r(e.trim())}))),a.length)if(p.database.hasOwnProperty(u)){for(i in p.database[u])(Array.isArray(d)&&!d.length||d.length&&-1===d.indexOf(i))&&(o=i===g||i===l?' selected="selected"':"",h=p.getOpt("combine")?p.database[u][i]+" ":"",f.push(['<option value="',i,'"',o,">",h+i,"</option>"].join("")));a.innerHTML=f.join(""),c(a,b)}else"value"in s&&(s.value="")})),e.appendChild(f);break;case"district":i(f,b,(function(e){var n=p.getEl(t,"county"),o=p.getEl(t,"district"),r=p.getEl(t,"zipcode");n&&o&&r&&p.database.hasOwnProperty(n.value)&&p.database[n.value].hasOwnProperty(o.value)&&(r.value=p.database[n.value][o.value],y.hasOwnProperty("onSelect")&&"function"==typeof y.onSelect&&y.onSelect.call(this,e,this.value))})),e.appendChild(f)}return"string"==typeof g&&g&&setTimeout((function(){(l=f.querySelector('[value="'+g+'"]'))&&(l.setAttribute("selected",!0),c(f,b))}),0),f},s.prototype.createInput=function(e,t,o,r){var s=this,u=a(!0,r,n.get(e)),l=document.createElement("input");if(l.setAttribute("type",u.type),l.setAttribute("name",u.name),l.setAttribute("id",[o,"-",t].join("")),l.setAttribute("placeholder",u.placeholder),l.setAttribute("pattern",u.pattern),l.className+=[u.css].join(" "),l.value=u.value,"number"===u.type)l.setAttribute("min",parseInt(u.min,10)),l.setAttribute("max",parseInt(u.max,10)),l.setAttribute("step",parseInt(u.step,10));else l.setAttribute("maxLength",parseInt(u.maxlength,10));return l.removeAttribute("data-role"),u.required&&l.setAttribute("required",!0),u.readonly&&l.setAttribute("readonly",!0),i(l,"keyup",(function(e){var n,o,r=s.getEl(t,"county"),i=s.getEl(t,"district"),a=(r&&r.value,i&&i.value,function(e){var t,n;for(t in s.database)if(s.database[t])for(n in s.database[t])if(e===s.database[t][n])return{county:t,district:n}}(this.value));a&&a.hasOwnProperty("county")&&a.hasOwnProperty("district")&&(r.value=a.county,c(r,"change"),i.value=a.district,c(i,"change"),n=a.county,o=a.district),"function"==typeof u.onKeyup&&u.onKeyup.call(this,e,n,o)})),"function"==typeof u.onBlur&&i(l,"blur",u.onBlur),"function"==typeof u.onFocus&&i(l,"focus",u.onFocus),u.value&&c(l,"keyup"),e.appendChild(l)},s.prototype.geolocation=function(){var e=this,t=e.container,n=navigator.geolocation,o=e.options.detect;n&&o&&n.watchPosition((function(n){var r={key:e.getOpt("GMAP_KEY"),sensor:!1};"coords"in n&&"latitude"in n.coords&&"longitude"in n.coords&&(r.latlng=[n.coords.latitude,n.coords.longitude].join(","),function(e,t,n,o){var r=new XMLHttpRequest;r.open("GET",[e,function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push([encodeURIComponent(t),encodeURIComponent(e[t])].join("="));return n.join("&")}(t)].join("?"),!0),r.onload=function(){if(r.status>=200&&r.status<400){var e=JSON.parse(r.responseText);"function"==typeof n&&n.call(this,e)}},r.onerror="function"==typeof o?o:function(){},r.send()}("https://maps.googleapis.com/maps/api/geocode/json",r,(function(r){var i="";r&&void 0!==r.results&&void 0!==r.results[0].address_components&&void 0!==r.results[0].address_components[0]&&(i=r.results[0].address_components[r.results[0].address_components.length-1].long_name)&&Array.prototype.forEach.call(t,(function(e){var t=e.querySelector("input");t&&(t.value=i.toString(),c(t,"keyup"))})),"function"==typeof o&&o.call(e,n)})))}),(function(e){console.error(e)}),{maximumAge:6e5,timeout:3e3,enableHighAccuracy:!1})},s.prototype.getEl=function(e,t){return document.querySelector(["#",t,"-",e].join(""))},s.prototype.createElements=function(){var e,t=this,n=t.container,o=t.options,r=t.getOpt("county"),i=t.getOpt("district"),a=t.getOpt("zipcode");Array.prototype.forEach.call(n,(function(n){var c=Math.random().toString(36).substr(2,10);Array.prototype.forEach.call(n.querySelectorAll("[data-role]"),(function(n){var s=n.getAttribute("data-role").toLowerCase();switch(s){case"county":e=t.createDropdownList(n,c,s,r);break;case"district":e=t.createDropdownList(n,c,s,i);break;case"zipcode":e=t.createInput(n,c,s,a),o.combine&&(e.removeAttribute("required"),e.style.display="none")}})),o.hasOwnProperty("created")&&"function"==typeof o.created&&o.created.call(t)}))},s.prototype.set=function(e){return Array.prototype.forEach.call(this.container,(function(t){var n=t.querySelector('[id^="county-"]'),o=t.querySelector('[id^="district-"]'),i=t.querySelector('[id^="zipcode-"]');e.substring||e.toFixed?(i.value=e,c(i,"keyup")):"object"==typeof e&&(e.hasOwnProperty("county")&&(n.value=r(e.county),c(n,"change")),e.hasOwnProperty("district")&&setTimeout((function(){o.value=r(e.district),c(o,"change")}),5),e.hasOwnProperty("zipcode")&&setTimeout((function(){i.value=parseInt(e.zipcode),c(i,"keyup")}),10))})),[]},s.prototype.get=function(e){var t=[],n=[];if(Array.prototype.forEach.call(this.container,(function(e){var t=e.querySelector('[id^="county-"]'),o=e.querySelector('[id^="district-"]'),r=e.querySelector('[id^="zipcode-"]');n.push({id:t.getAttribute("id").replace(/county\-/g,""),county:t.value,district:o.value,zipcode:r.value})})),"function"==typeof e)e.call(this,n);else if("string"==typeof e)switch(e.toLowerCase()){case"county":case"district":case"zipcode":return n.forEach((function(n){t.push(n[e])})),t}return n},s.prototype.serialize=function(){var e=[];return Array.prototype.forEach.call(this.container,(function(t){t.querySelector('[id^="county-"]'),t.querySelector('[id^="district-"]'),t.querySelector('[id^="zipcode-"]');e.push(elCounty.getAttribute("name")+"="+elCounty.value),e.push(elDistrict.getAttribute("name")+"="+elDistrict.value),e.push(elZipcode.getAttribute("name")+"="+elZipcode.value)})),resulresult},s.prototype.destroy=function(){try{Array.prototype.forEach.call(this.container,(function(e){var t=e.querySelector('[id^="county-"]'),n=e.querySelector('[id^="district-"]'),o=e.querySelector('[id^="zipcode-"]');t.parentNode.removeChild(t),n.parentNode.removeChild(n),o.parentNode.removeChild(o),e.removeAttribute("id"),e.removeAttribute("data-twzipcode")}))}catch(e){console.warn(e)}},s.prototype.init=function(){this.createElements(),this.geolocation()},s.create=function(e,t){return new s(e,t)},s.VERSION="2.0.5",s}));